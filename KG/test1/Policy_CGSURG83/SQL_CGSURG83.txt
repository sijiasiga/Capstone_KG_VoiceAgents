SELECT DISTINCT patient_id, *
FROM patients
WHERE patient_age >= 18
  AND (
        patient_bmi >= 40.0
        OR (patient_bmi >= 35.0 AND comorbidity_flag = TRUE)
        OR procedure_code_CPT IN ('43644','43645','43770','43771','43772','43773','43774','43775','43842','43843','43845','43846','43847','43848','43886','43887','43888')
        OR procedure_code_ICD10PCS IN ('0DP60CZ','0DP64CZ','0DV60CZ','0DV64CZ','0DV60ZZ','0DV64ZZ','0DW60CZ','0DW64CZ','0D160ZA','0D160ZB','0D164ZA','0D164ZB','0D164Z9','0D190ZB','0DB60Z3','0DB64Z3','0DB68Z3','0DB60ZZ','0DB64ZZ')
        OR diagnosis_code_ICD10 IN ('E66.01','E66.09','E66.1','E66.2','E66.3','E66.811','E66.812','E66.813','E66.89','E66.9','E88.82','Z46.51','Z68.35','Z68.36','Z68.37','Z68.38','Z68.39','Z68.41','Z68.42','Z68.43','Z68.44','Z68.45','Z68.51','Z68.52','Z68.53','Z68.54','Z68.55','Z68.56','Z98.84')
      )
  AND weight_loss_program_history = TRUE
  AND conservative_therapy_attempt = TRUE
  AND preop_medical_clearance = TRUE
  AND preop_psych_clearance = TRUE
  AND preop_education_completed = TRUE
  AND treatment_plan_documented = TRUE;
