```sql
SELECT *
FROM patients
WHERE
  /*
Policy: CG-SURG-83 Bariatric Surgery and Other Treatments for Clinically Severe Obesity
Total Restrictions: 53
*/
  -- Restriction 1: Individual is age 18 years or older for medically necessary gastric bypass and gastric restrictive procedures.
  patient_age >= 18
  AND
  -- Restriction 2: Recommended bariatric procedure is Biliopancreatic bypass with duodenal switch.
  procedure_type_biliopancreatic_bypass_duodenal_switch = TRUE
  AND
  -- Restrictions 3-6: Recommended bariatric procedure is Laparoscopic adjustable gastric banding. or similar conditions
  (
    procedure_type_laparoscopic_adjustable_gastric_banding = TRUE
    OR
    procedure_type_roux_en_y_gastric_bypass = TRUE
    OR
    procedure_type_sleeve_gastrectomy = TRUE
    OR
    procedure_type_vertical_banded_gastroplasty = TRUE
  )
  AND
  -- Restriction 7: Body Mass Index (BMI) of 40 or greater.
  patient_bmi_threshold_40 >= 40.0
  AND
  -- Restrictions 8-13: Body Mass Index (BMI) of 35 or greater with an obesity-related co-morbid condition, specifically Diabetes mellitus. or similar conditions
  (
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_diabetes_mellitus = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_cardiovascular_disease = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_hypertension = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_obstructive_sleep_apnea = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_pickwickian_syndrome = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_obesity_related_cardiomyopathy = TRUE
  )
  AND
  -- Restriction 14: Documentation of past participation in a weight loss program.
  past_weight_loss_program_participation = TRUE
  AND
  -- Restriction 15: Documentation of inadequate weight loss despite a committed attempt at conservative medical therapy.
  inadequate_weight_loss_conservative_therapy = TRUE
  AND
  -- Restriction 16: Documentation of pre-operative medical and mental health evaluations and clearances.
  preoperative_medical_mental_health_clearance = TRUE
  AND
  -- Restriction 17: Documentation of pre-operative education addressing risks, benefits, realistic expectations and the need for long-term follow-up and adherence to behavioral modifications.
  preoperative_education_complete = TRUE
  AND
  -- Restriction 18: Documentation of a treatment plan addressing the pre- and post-operative needs of an individual undergoing bariatric surgery.
  bariatric_surgery_treatment_plan = TRUE
  AND
  -- Restriction 19: Surgical repair/correction or reversal following gastric bypass and gastric restrictive procedures for a surgical complication related to the original surgery, specifically a fistula.
  surgical_complication_fistula = TRUE
  AND
  -- Restrictions 20-26: Surgical repair/correction or reversal following gastric bypass and gastric restrictive procedures for a surgical complication related to the original surgery, specifically an obstruction. or similar conditions
  (
    surgical_complication_obstruction = TRUE
    OR
    surgical_complication_erosion = TRUE
    OR
    surgical_complication_suture_staple_leakage = TRUE
    OR
    surgical_complication_band_herniation = TRUE
    OR
    surgical_complication_stricture = TRUE
    OR
    diagnosis_gastroesophageal_reflux_disease_GERD = TRUE
    OR
    surgical_complication_pouch_enlargement_dilation = TRUE
  )
  AND
  -- Restriction 27: For surgical revision/conversion due to inadequate weight loss or weight gain 1 year or longer after a prior procedure, the individual must meet all subsequent criteria.
  inadequate_weight_loss_or_regain_post_procedure_duration_years >= 1
  AND
  -- Restriction 28: For surgical revision/conversion due to inadequate weight loss or weight gain, BMI of 40 or greater.
  patient_bmi_threshold_40 >= 40.0
  AND
  -- Restrictions 29-34: For surgical revision/conversion due to inadequate weight loss or weight gain, BMI of 35 or greater with an obesity-related co-morbid condition, specifically Diabetes mellitus. or similar conditions
  (
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_diabetes_mellitus = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_cardiovascular_disease = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_hypertension = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_obstructive_sleep_apnea = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_pickwickian_syndrome = TRUE
    OR
    patient_bmi_threshold_35 >= 35.0 AND diagnosis_obesity_related_cardiomyopathy = TRUE
  )
  AND
  -- Restriction 35: For surgical revision/conversion, documentation of pre-operative medical and mental health evaluations and clearances.
  preoperative_medical_mental_health_clearance = TRUE
  AND
  -- Restriction 36: For surgical revision/conversion, documentation of pre-operative education which addresses the risks, benefits, realistic expectations and the need for long-term follow-up and adherence to behavioral modifications.
  preoperative_education_complete = TRUE
  AND
  -- Restriction 37: For surgical revision/conversion, documentation of a treatment plan which addresses the pre- and post-operative needs of an individual undergoing bariatric surgery.
  bariatric_surgery_treatment_plan = TRUE
  AND
  -- Restrictions 38-40: Surgical revision/conversion is medically necessary when there is documentation of a complication related to the initial procedure, specifically obstruction. or similar conditions
  (
    surgical_complication_obstruction = TRUE
    OR
    surgical_complication_stricture = TRUE
    OR
    diagnosis_gastroesophageal_reflux_disease_GERD = TRUE
  )
  AND
  -- Restriction 41: Initial and reoperative bariatric procedures are considered not medically necessary when the medically necessary criteria are not met.
  (NOT (patient_age >= 18)) OR (NOT (procedure_type_biliopancreatic_bypass_duodenal_switch = TRUE OR procedure_type_laparoscopic_adjustable_gastric_banding = TRUE OR procedure_type_roux_en_y_gastric_bypass = TRUE OR procedure_type_sleeve_gastrectomy = TRUE OR procedure_type_vertical_banded_gastroplasty = TRUE)) OR (NOT (patient_bmi_threshold_40 >= 40.0 OR (patient_bmi_threshold_35 >= 35.0 AND (diagnosis_diabetes_mellitus = TRUE OR diagnosis_cardiovascular_disease = TRUE OR diagnosis_hypertension = TRUE OR diagnosis_obstructive_sleep_apnea = TRUE OR diagnosis_pickwickian_syndrome = TRUE OR diagnosis_obesity_related_cardiomyopathy = TRUE)))) OR (NOT (past_weight_loss_program_participation = TRUE AND inadequate_weight_loss_conservative_therapy = TRUE AND preoperative_medical_mental_health_clearance = TRUE AND preoperative_education_complete = TRUE AND bariatric_surgery_treatment_plan = TRUE))
  AND
  -- Restriction 42: Endoluminal reoperative bariatric procedures, including transoral outlet reduction (TORe) or restorative obesity surgery endoluminal (ROSE), are considered not medically necessary for all indications.
  NOT (procedure_type_other IN ('transoral outlet reduction', 'restorative obesity surgery endoluminal'))
  AND
  -- Restriction 43: Laparoscopic adjustable gastric banding is considered not medically necessary for individuals with a BMI below 35 kg/m².
  procedure_type_laparoscopic_adjustable_gastric_banding = TRUE AND patient_bmi_threshold_35 < 35.0
  AND
  -- Restriction 44: One anastomosis gastric bypass (mini gastric bypass) is not medically necessary.
  procedure_not_medically_necessary_one_anastomosis_gastric_bypass = TRUE
  AND
  -- Restriction 45: Malabsorptive procedure: Jejunoileal bypass is not medically necessary.
  procedure_not_medically_necessary_jejunoileal_bypass = TRUE
  AND
  -- Restrictions 46-48: Malabsorptive procedure: Biliopancreatic bypass without duodenal switch is not medically necessary. or similar conditions
  (
    procedure_not_medically_necessary_biliopancreatic_bypass_without_duodenal_switch = TRUE
    OR
    procedure_not_medically_necessary_single_anastomosis_duodenal_switch = TRUE
    OR
    procedure_not_medically_necessary_very_long_limb_gastric_bypass = TRUE
  )
  AND
  -- Restriction 49: Minimally invasive endoluminal gastric restrictive surgical technique: EndoGastric StomaphyX™ endoluminal fastener and delivery system is not medically necessary.
  device_not_medically_necessary_endogastric_stomaphyx = TRUE
  AND
  -- Restriction 50: Minimally invasive endoluminal gastric restrictive surgical technique: Endoscopic sleeve gastroplasty is not medically necessary.
  procedure_not_medically_necessary_endoscopic_sleeve_gastroplasty_minimally_invasive = TRUE
  AND
  -- Restriction 51: Laparoscopic gastric plication (LGCP) with or without gastric banding is not medically necessary.
  procedure_not_medically_necessary_laparoscopic_gastric_plication = TRUE
  AND
  -- Restriction 52: Balloon system: Orbera Intragastric Balloon System is not medically necessary.
  device_not_medically_necessary_orbera_intragastric_balloon = TRUE
  AND
  -- Restriction 53: Balloon system: TransPyloric Shuttle is not medically necessary.
  device_not_medically_necessary_transpyloric_shuttle = TRUE
  AND
  -- Restriction 54: Vagus (or vagal) nerve blocking devices are not medically necessary.
  device_not_medically_necessary_vagus_nerve_blocking_devices = TRUE
  AND
  -- Restriction 55: Endoscopically placed percutaneous aspiration tube (AspireAssist®) is not medically necessary.
  device_not_medically_necessary_aspireassist = TRUE
  AND
  -- Restriction 56: Bariatric surgery for individuals under 18 years old with severe morbid obesity and unique circumstances may be considered with Medical Director approval.
  patient_age < 18 AND patient_age_pediatric_consideration = TRUE
  AND
  -- Restriction 57: Adolescent age range (10 to 19 years) for bariatric surgery consideration.
  patient_age >= patient_age_adolescent_range_start AND patient_age <= patient_age_adolescent_range_end
  AND
  -- Restriction 58: Pediatric BMI threshold of 35 kg/m2 or 120% of the 95th percentile with a clinically significant co-morbid condition(s) for surgical consideration.
  patient_bmi_pediatric_threshold_35_or_120th_percentile >= 35.0 AND obesity_related_comorbidity_present = TRUE
  AND
  -- Restriction 59: Pediatric BMI threshold of 40 kg/m2 or 140% of the 95th percentile (whichever is lower) for surgical consideration.
  patient_bmi_pediatric_threshold_40_or_140th_percentile >= 40.0
  AND
  -- Restriction 60: Laparoscopic Roux-en-Y Gastric Bypass (RYGB) is considered a common and effective procedure in pediatric population.
  procedure_type_laparoscopic_rygb_pediatric = TRUE
  AND
  -- Restriction 61: Vertical Sleeve Gastrectomy is considered a common and effective procedure in pediatric population.
  procedure_type_vertical_sleeve_gastrectomy_pediatric = TRUE
  AND
  -- Restriction 62: Patient's Tanner pubertal development stage is 4 or 5 for pediatric bariatric surgery eligibility.
  patient_tanner_stage IN ('4','5')
  AND
  -- Restriction 63: Patient has achieved final or near final adult height for pediatric bariatric surgery eligibility.
  patient_adult_height_achieved_flag = TRUE
  AND
  -- Restriction 64: Metabolic surgery may be considered for adolescents with type 2 diabetes and Class 2 obesity or higher (BMI > 35 kg/m2 or 120% of 95th percentile for age and sex, whichever is lower).
  diagnosis_diabetes_mellitus = TRUE AND adolescent_diabetes_class2_obesity_bmi_threshold = TRUE
  AND
  -- Restrictions 65-66: Adolescent patient has elevated A1C despite lifestyle and pharmacologic intervention. or similar conditions
  (
    patient_A1C_elevated_flag = TRUE
    OR
    patient_serious_comorbidities_flag = TRUE
  )
  AND
  -- Restriction 67: Eligible individuals under the age of 18 years must be skeletally mature for surgery consideration.
  patient_skeletal_maturity_flag = TRUE
  AND
  -- Restriction 68: Eligible individuals under the age of 18 years must have a suitable psychiatric profile and developmental stage for pre- and post-operative care compliance and long-term follow-up.
  patient_psychiatric_profile_suitable = TRUE
  AND
  -- Restriction 69: Informed consent must be conducted including documentation that the individual has received and can fully understand a thorough explanation of the risks, benefits, and uncertainties of the procedure.
  informed_consent_documentation = TRUE
  AND
  -- Restriction 70: Medically necessary CPT codes for gastric bypass and gastric restrictive procedures/reoperations.
  procedure_code_CPT_medically_necessary_bariatric_surgery IN ('43644','43645','43770','43771','43772','43773','43774','43775','43842','43843','43845','43846','43847','43848','43886','43887','43888')
  AND
  -- Restriction 71: Medically necessary ICD-10-PCS codes for gastric restrictive procedures and reoperations.
  procedure_code_ICD10PCS_medically_necessary_gastric_restrictive_reoperations IN ('0DP60CZ','0DP64CZ','0DV60CZ','0DV64CZ','0DV60ZZ','0DV64ZZ','0DW60CZ','0DW64CZ')
  AND
  -- Restriction 72: Medically necessary ICD-10-PCS codes for other bypass and excision procedures.
  procedure_code_ICD10PCS_medically_necessary_bypass_excision IN ('0D160ZA','0D160ZB','0D164ZA','0D164ZB','0D164Z9','0D190ZB','0DB60Z3','0DB64Z3','0DB68Z3','0DB60ZZ','0DB64ZZ')
  AND
  -- Restriction 73: Medically necessary ICD-10 Diagnosis codes for obesity and BMI.
  diagnosis_code_ICD10_medically_necessary_obesity_bmi IN ('E66.01','E66.09','E66.1','E66.2','E66.3','E66.811','E66.812','E66.813','E66.89','E66.9','E88.82','Z46.51','Z68.35','Z68.36','Z68.37','Z68.38','Z68.39','Z68.41','Z68.42','Z68.43','Z68.44','Z68.45','Z68.51','Z68.52','Z68.53','Z68.54','Z68.55','Z68.56','Z98.84')
  AND
  -- Restriction 74: ICD-10 Diagnosis codes indicating BMI ranges considered not medically necessary (BMI 20.0-29.9, adult).
  diagnosis_code_ICD10_not_medically_necessary_bmi_range IN ('Z68.20','Z68.21','Z68.22','Z68.23','Z68.24','Z68.25','Z68.26','Z68.27','Z68.28','Z68.29')
  AND
  -- Restriction 75: ICD-10 Diagnosis codes indicating BMI ranges considered not medically necessary (BMI 30.0-34.9, adult).
  diagnosis_code_ICD10_not_medically_necessary_bmi_range IN ('Z68.30','Z68.31','Z68.32','Z68.33','Z68.34')
  AND
  -- Restriction 76: CPT codes for procedures identified as not medically necessary.
  procedure_code_CPT_not_medically_necessary_other_procedures IN ('43290','43291','43632','43633','43659','43999','44238','64999','0813T')
  AND
  -- Restriction 77: HCPCS codes for procedures identified as not medically necessary.
  procedure_code_HCPCS_not_medically_necessary_other_procedures IN ('C9784','C9785')
  AND
  -- Restriction 78: ICD-10-PCS codes for procedures identified as not medically necessary.
  procedure_code_ICD10PCS_not_medically_necessary_other_procedures IN ('0D160ZA','0DV60DZ','0DV63DZ','0DV64DZ','0DV67DZ','0DV68DZ','0DP60DZ','0DP63DZ','0DP64DZ','0DP67DZ','0DP68DZ');
```