SELECT *
FROM patients
WHERE
  pva_procedure_type IN ('PVP','PKP')
  AND (
    vcf_onset_category IN ('acute','subacute')
    OR vcf_symptom_duration_weeks < 6
    OR vcf_symptom_duration_weeks BETWEEN 6 AND 12
  )
  AND vcf_level_range = 'T1â€“L5'
  AND advanced_imaging_confirmation = TRUE
  AND (
    imaging_finding_bone_marrow_edema = TRUE
    OR imaging_finding_nuclear_uptake = TRUE
  )
  AND (
    (
      hospitalized_status = TRUE
      AND (
        pain_score_NRS >= pain_threshold_hospitalized_NRS_or_VAS
        OR pain_score_VAS >= pain_threshold_hospitalized_NRS_or_VAS
      )
    )
    OR (
      hospitalized_status = FALSE
      AND optimal_nonsurgical_management_attempted = TRUE
      AND (
        pain_score_NRS >= pain_threshold_nonhospitalized_NRS_or_VAS
        OR pain_score_VAS >= pain_threshold_nonhospitalized_NRS_or_VAS
      )
      AND pain_worsening_on_nsm = TRUE
    )
    OR (
      hospitalized_status = FALSE
      AND optimal_nonsurgical_management_attempted = TRUE
      AND pain_persistent_ge5_on_nsm = TRUE
      AND (
        pain_score_NRS >= pain_threshold_nonhospitalized_NRS_or_VAS
        OR pain_score_VAS >= pain_threshold_nonhospitalized_NRS_or_VAS
      )
      AND (
        (CASE WHEN vertebral_height_loss_progression THEN 1 ELSE 0 END)
        + (CASE WHEN vertebral_height_loss_percent > 25 THEN 1 ELSE 0 END)
        + (CASE WHEN kyphotic_deformity_present THEN 1 ELSE 0 END)
        + (CASE WHEN rdq_score > 17 THEN 1 ELSE 0 END)
      ) >= 2
    )
  )
  AND bmd_evaluation_referral = TRUE
  AND osteoporosis_education_provided = TRUE
  AND osteoporosis_prevention_treatment_program_participation = TRUE
  AND exclusion_pain_not_due_to_identified_vcf = FALSE
  AND exclusion_active_infection = FALSE
  AND exclusion_pregnancy = FALSE
  AND exclusion_fractures_per_procedure_count <= 3
  AND exclusion_bone_cement_or_opacifier_allergy = FALSE
  AND exclusion_uncorrected_coagulopathy = FALSE
  AND exclusion_spinal_instability = FALSE
  AND exclusion_myelopathy_from_fracture = FALSE
  AND exclusion_neurologic_deficit = FALSE
  AND exclusion_neural_impingement = FALSE
  AND exclusion_canal_compromise_or_retropulsion = FALSE;
